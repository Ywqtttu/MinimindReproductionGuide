<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5584.375px" preserveAspectRatio="none" style="width:2685px;height:5584px;" version="1.1" viewBox="0 0 2685 5584" width="2685.4167px" zoomAndPan="magnify"><defs><linearGradient id="gbtucmjli9kwn0" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient><filter height="300%" id="fbtucmjli9kwn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0833333333333335"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.166666666666667" dy="4.166666666666667" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter><linearGradient id="gbtucmjli9kwn1" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#4DABF5"/><stop offset="100%" stop-color="#2196F3"/></linearGradient><linearGradient id="gbtucmjli9kwn2" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#2196F3"/><stop offset="100%" stop-color="#1A78C2"/></linearGradient><linearGradient id="gbtucmjli9kwn3" x1="50%" x2="50%" y1="0%" y2="100%"><stop offset="0%" stop-color="#B052C0"/><stop offset="100%" stop-color="#9C27B0"/></linearGradient></defs><g><!--cluster nn--><g id="cluster_nn"><path d="M825,226.5625 L860.4167,226.5625 A6.25,6.25 0 0 1 864.5833,230.7292 L871.875,268.8375 L943.75,268.8375 A4.1667,4.1667 0 0 1 947.9167,273.0042 L947.9167,355.7292 A4.1667,4.1667 0 0 1 943.75,359.8958 L825,359.8958 A4.1667,4.1667 0 0 1 820.8333,355.7292 L820.8333,230.7292 A4.1667,4.1667 0 0 1 825,226.5625 " fill="url(#gbtucmjli9kwn0)" filter="url(#fbtucmjli9kwn)" style="stroke:#2196F3;stroke-width:2.0833333333333335;"/><line style="stroke:#2196F3;stroke-width:2.0833333333333335;" x1="820.8333" x2="871.875" y1="268.8375" y2="268.8375"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="16.6667" x="835.4167" y="251.6296">nn</text></g><!--class Module--><g id="elem_Module"><rect codeLine="12" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="61.8423" id="Module" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="93.75" x="837.5" y="281.7708"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="93.75" x="837.5" y="281.7708"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="93.75" x="837.5" y="322.7798"/><rect codeLine="12" fill="none" height="61.8423" id="Module" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="93.75" x="837.5" y="281.7708"/><ellipse cx="852.0833" cy="304.3587" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M853.6296,301.4453 Q853.7435,301.2825 853.8737,301.2011 Q854.0202,301.1197 854.1829,301.1197 Q854.4596,301.1197 854.6224,301.3151 Q854.8014,301.5104 854.8014,301.9498 L854.8014,303.024 Q854.8014,303.4635 854.6224,303.6588 Q854.4596,303.8541 854.1829,303.8541 Q853.9225,303.8541 853.776,303.7076 Q853.6296,303.5774 853.5482,303.1868 Q853.5156,302.9264 853.3854,302.7962 Q853.125,302.5195 852.6693,302.3567 Q852.2298,302.194 851.7741,302.194 Q851.2207,302.194 850.7487,302.4381 Q850.2767,302.6822 849.9186,303.2356 Q849.5605,303.7727 849.5605,304.5377 L849.5605,305.3515 Q849.5605,306.2467 850.2116,306.8489 Q850.8789,307.4511 852.0345,307.4511 Q852.7344,307.4511 853.2227,307.2721 Q853.4993,307.1582 853.8086,306.8326 Q854.0039,306.6373 854.1178,306.5885 Q854.2318,306.5234 854.362,306.5234 Q854.6224,306.5234 854.8014,306.7187 Q854.9967,306.8977 854.9967,307.1582 Q854.9967,307.4186 854.7363,307.7115 Q854.362,308.1347 853.776,308.3789 Q852.9948,308.7044 852.0508,308.7044 Q850.9277,308.7044 850.0488,308.2486 Q849.3164,307.8906 848.8118,307.093 Q848.3073,306.2955 848.3073,305.3678 L848.3073,304.5214 Q848.3073,303.5449 848.763,302.6985 Q849.2188,301.8522 850.0163,301.3964 Q850.8301,300.9407 851.7253,300.9407 Q852.2786,300.9407 852.7507,301.0709 Q853.2227,301.1848 853.6296,301.4453 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="41.6667" x="876.0417" y="308.9157">Module</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="838.5417" x2="930.2083" y1="326.9465" y2="326.9465"/><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="838.5417" x2="930.2083" y1="335.2798" y2="335.2798"/></g><!--class PretrainedConfig--><g id="elem_PretrainedConfig"><rect codeLine="6" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="61.8423" id="PretrainedConfig" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="152.0833" x="17.7083" y="3501.0417"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="152.0833" x="17.7083" y="3501.0417"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="152.0833" x="17.7083" y="3542.0507"/><rect codeLine="6" fill="none" height="61.8423" id="PretrainedConfig" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="152.0833" x="17.7083" y="3501.0417"/><ellipse cx="32.2917" cy="3523.6295" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M33.8379,3520.7161 Q33.9518,3520.5533 34.082,3520.472 Q34.2285,3520.3906 34.3913,3520.3906 Q34.668,3520.3906 34.8307,3520.5859 Q35.0098,3520.7812 35.0098,3521.2207 L35.0098,3522.2949 Q35.0098,3522.7343 34.8307,3522.9296 Q34.668,3523.1249 34.3913,3523.1249 Q34.1309,3523.1249 33.9844,3522.9785 Q33.8379,3522.8483 33.7565,3522.4576 Q33.724,3522.1972 33.5938,3522.067 Q33.3333,3521.7903 32.8776,3521.6276 Q32.4382,3521.4648 31.9824,3521.4648 Q31.429,3521.4648 30.957,3521.7089 Q30.485,3521.9531 30.127,3522.5065 Q29.7689,3523.0436 29.7689,3523.8085 L29.7689,3524.6223 Q29.7689,3525.5175 30.4199,3526.1197 Q31.0872,3526.722 32.2428,3526.722 Q32.9427,3526.722 33.431,3526.5429 Q33.7077,3526.429 34.0169,3526.1035 Q34.2122,3525.9082 34.3262,3525.8593 Q34.4401,3525.7942 34.5703,3525.7942 Q34.8307,3525.7942 35.0098,3525.9895 Q35.2051,3526.1686 35.2051,3526.429 Q35.2051,3526.6894 34.9447,3526.9824 Q34.5703,3527.4055 33.9844,3527.6497 Q33.2031,3527.9752 32.2591,3527.9752 Q31.1361,3527.9752 30.2572,3527.5195 Q29.5247,3527.1614 29.0202,3526.3639 Q28.5156,3525.5664 28.5156,3524.6386 L28.5156,3523.7923 Q28.5156,3522.8157 28.9714,3521.9694 Q29.4271,3521.123 30.2246,3520.6673 Q31.0384,3520.2115 31.9336,3520.2115 Q32.487,3520.2115 32.959,3520.3417 Q33.431,3520.4557 33.8379,3520.7161 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="100" x="56.25" y="3528.1865">PretrainedConfig</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="18.75" x2="168.75" y1="3546.2173" y2="3546.2173"/><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="18.75" x2="168.75" y1="3554.5507" y2="3554.5507"/></g><!--class PreTrainedModel--><g id="elem_PreTrainedModel"><rect codeLine="8" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="61.8423" id="PreTrainedModel" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="151.0417" x="2327.6042" y="17.7083"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="151.0417" x="2327.6042" y="17.7083"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="151.0417" x="2327.6042" y="58.7173"/><rect codeLine="8" fill="none" height="61.8423" id="PreTrainedModel" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="151.0417" x="2327.6042" y="17.7083"/><ellipse cx="2342.1875" cy="40.2962" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M2343.7337,37.3828 Q2343.8477,37.22 2343.9779,37.1386 Q2344.1243,37.0572 2344.2871,37.0572 Q2344.5638,37.0572 2344.7266,37.2526 Q2344.9056,37.4479 2344.9056,37.8873 L2344.9056,38.9615 Q2344.9056,39.401 2344.7266,39.5963 Q2344.5638,39.7916 2344.2871,39.7916 Q2344.0267,39.7916 2343.8802,39.6451 Q2343.7337,39.5149 2343.6523,39.1243 Q2343.6198,38.8639 2343.4896,38.7337 Q2343.2292,38.457 2342.7734,38.2942 Q2342.334,38.1315 2341.8783,38.1315 Q2341.3249,38.1315 2340.8529,38.3756 Q2340.3809,38.6197 2340.0228,39.1731 Q2339.6647,39.7102 2339.6647,40.4752 L2339.6647,41.289 Q2339.6647,42.1842 2340.3158,42.7864 Q2340.9831,43.3886 2342.1387,43.3886 Q2342.8385,43.3886 2343.3268,43.2096 Q2343.6035,43.0957 2343.9128,42.7701 Q2344.1081,42.5748 2344.222,42.526 Q2344.3359,42.4609 2344.4661,42.4609 Q2344.7266,42.4609 2344.9056,42.6562 Q2345.1009,42.8352 2345.1009,43.0957 Q2345.1009,43.3561 2344.8405,43.649 Q2344.4661,44.0722 2343.8802,44.3164 Q2343.099,44.6419 2342.1549,44.6419 Q2341.0319,44.6419 2340.153,44.1861 Q2339.4206,43.8281 2338.916,43.0305 Q2338.4115,42.233 2338.4115,41.3053 L2338.4115,40.4589 Q2338.4115,39.4824 2338.8672,38.636 Q2339.3229,37.7897 2340.1204,37.3339 Q2340.9342,36.8782 2341.8294,36.8782 Q2342.3828,36.8782 2342.8548,37.0084 Q2343.3268,37.1223 2343.7337,37.3828 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="98.9583" x="2366.1458" y="44.8532">PreTrainedModel</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2328.6458" x2="2477.6042" y1="62.884" y2="62.884"/><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2328.6458" x2="2477.6042" y1="71.2173" y2="71.2173"/></g><!--class GenerationMixin--><g id="elem_GenerationMixin"><rect codeLine="10" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="61.8423" id="GenerationMixin" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="147.9167" x="2458.3333" y="895.3125"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="147.9167" x="2458.3333" y="895.3125"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="147.9167" x="2458.3333" y="936.3215"/><rect codeLine="10" fill="none" height="61.8423" id="GenerationMixin" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="147.9167" x="2458.3333" y="895.3125"/><ellipse cx="2472.9167" cy="917.9003" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M2474.4629,914.9869 Q2474.5768,914.8242 2474.707,914.7428 Q2474.8535,914.6614 2475.0163,914.6614 Q2475.293,914.6614 2475.4557,914.8567 Q2475.6348,915.052 2475.6348,915.4915 L2475.6348,916.5657 Q2475.6348,917.0052 2475.4557,917.2005 Q2475.293,917.3958 2475.0163,917.3958 Q2474.7559,917.3958 2474.6094,917.2493 Q2474.4629,917.1191 2474.3815,916.7285 Q2474.349,916.468 2474.2188,916.3378 Q2473.9583,916.0611 2473.5026,915.8984 Q2473.0632,915.7356 2472.6074,915.7356 Q2472.054,915.7356 2471.582,915.9798 Q2471.11,916.2239 2470.752,916.7773 Q2470.3939,917.3144 2470.3939,918.0794 L2470.3939,918.8932 Q2470.3939,919.7884 2471.0449,920.3906 Q2471.7122,920.9928 2472.8678,920.9928 Q2473.5677,920.9928 2474.056,920.8138 Q2474.3327,920.6998 2474.6419,920.3743 Q2474.8372,920.179 2474.9512,920.1302 Q2475.0651,920.0651 2475.1953,920.0651 Q2475.4557,920.0651 2475.6348,920.2604 Q2475.8301,920.4394 2475.8301,920.6998 Q2475.8301,920.9602 2475.5697,921.2532 Q2475.1953,921.6764 2474.6094,921.9205 Q2473.8281,922.246 2472.8841,922.246 Q2471.7611,922.246 2470.8822,921.7903 Q2470.1497,921.4322 2469.6452,920.6347 Q2469.1406,919.8372 2469.1406,918.9095 L2469.1406,918.0631 Q2469.1406,917.0865 2469.5964,916.2402 Q2470.0521,915.3938 2470.8496,914.9381 Q2471.6634,914.4824 2472.5586,914.4824 Q2473.112,914.4824 2473.584,914.6126 Q2474.056,914.7265 2474.4629,914.9869 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="95.8333" x="2496.875" y="922.4574">GenerationMixin</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2459.375" x2="2605.2083" y1="940.4882" y2="940.4882"/><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2459.375" x2="2605.2083" y1="948.8215" y2="948.8215"/></g><!--class MiniMindConfig--><g id="elem_MiniMindConfig"><rect codeLine="16" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="1556.4799" id="MiniMindConfig" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="229.1667" x="829.1667" y="4010.4167"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="229.1667" x="829.1667" y="4010.4167"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="229.1667" x="829.1667" y="4051.4257"/><rect codeLine="16" fill="none" height="1556.4799" id="MiniMindConfig" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="229.1667" x="829.1667" y="4010.4167"/><ellipse cx="884.8958" cy="4033.0045" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M886.4421,4030.0911 Q886.556,4029.9283 886.6862,4029.847 Q886.8327,4029.7656 886.9954,4029.7656 Q887.2721,4029.7656 887.4349,4029.9609 Q887.6139,4030.1562 887.6139,4030.5957 L887.6139,4031.6699 Q887.6139,4032.1093 887.4349,4032.3046 Q887.2721,4032.4999 886.9954,4032.4999 Q886.735,4032.4999 886.5885,4032.3535 Q886.4421,4032.2233 886.3607,4031.8326 Q886.3281,4031.5722 886.1979,4031.442 Q885.9375,4031.1653 885.4818,4031.0026 Q885.0423,4030.8398 884.5866,4030.8398 Q884.0332,4030.8398 883.5612,4031.0839 Q883.0892,4031.3281 882.7311,4031.8815 Q882.373,4032.4186 882.373,4033.1835 L882.373,4033.9973 Q882.373,4034.8925 883.0241,4035.4947 Q883.6914,4036.097 884.847,4036.097 Q885.5469,4036.097 886.0352,4035.9179 Q886.3118,4035.804 886.6211,4035.4785 Q886.8164,4035.2832 886.9303,4035.2343 Q887.0443,4035.1692 887.1745,4035.1692 Q887.4349,4035.1692 887.6139,4035.3645 Q887.8092,4035.5436 887.8092,4035.804 Q887.8092,4036.0644 887.5488,4036.3574 Q887.1745,4036.7805 886.5885,4037.0247 Q885.8073,4037.3502 884.8633,4037.3502 Q883.7402,4037.3502 882.8613,4036.8945 Q882.1289,4036.5364 881.6243,4035.7389 Q881.1198,4034.9414 881.1198,4034.0136 L881.1198,4033.1673 Q881.1198,4032.1907 881.5755,4031.3444 Q882.0313,4030.498 882.8288,4030.0423 Q883.6426,4029.5865 884.5378,4029.5865 Q885.0911,4029.5865 885.5632,4029.7167 Q886.0352,4029.8307 886.4421,4030.0911 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="88.5417" x="915.1042" y="4037.5615">MiniMindConfig</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="830.2083" x2="1057.2917" y1="4055.5923" y2="4055.5923"/><ellipse cx="840.625" cy="4078.701" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="81.25" x="859.375" y="4081.6956">dropout: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4116.4546">&#160;</text><ellipse cx="840.625" cy="4148.219" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="859.375" y="4151.2136">bos_token_id: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4185.9726">&#160;</text><ellipse cx="840.625" cy="4217.7371" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="859.375" y="4220.7316">eos_token_id: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4255.4906">&#160;</text><ellipse cx="840.625" cy="4287.2551" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="89.5833" x="859.375" y="4290.2496">hidden_act: str</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4325.0086">&#160;</text><ellipse cx="840.625" cy="4356.7731" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="93.75" x="859.375" y="4359.7677">hidden_size: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4394.5267">&#160;</text><ellipse cx="840.625" cy="4426.2911" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="859.375" y="4429.2857">intermediate_size: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4464.0447">&#160;</text><ellipse cx="840.625" cy="4495.8092" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="182.2917" x="859.375" y="4498.8037">max_position_embeddings: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4533.5627">&#160;</text><ellipse cx="840.625" cy="4565.3272" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="152.0833" x="859.375" y="4568.3217">num_attention_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4603.0807">&#160;</text><ellipse cx="840.625" cy="4634.8452" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="140.625" x="859.375" y="4637.8398">num_hidden_layers: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4672.5988">&#160;</text><ellipse cx="840.625" cy="4704.3633" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="161.4583" x="859.375" y="4707.3578">num_key_value_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4742.1168">&#160;</text><ellipse cx="840.625" cy="4773.8813" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="89.5833" x="859.375" y="4776.8758">vocab_size: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4811.6348">&#160;</text><ellipse cx="840.625" cy="4843.3993" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="125" x="859.375" y="4846.3938">rms_norm_eps: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4881.1529">&#160;</text><ellipse cx="840.625" cy="4912.9173" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="100" x="859.375" y="4915.9119">rope_theta: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="4950.6709">&#160;</text><ellipse cx="840.625" cy="4982.4354" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="92.7083" x="859.375" y="4985.4299">flash_attn: bool</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5020.1889">&#160;</text><ellipse cx="840.625" cy="5051.9534" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="88.5417" x="859.375" y="5054.9479">use_moe: bool</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5089.7069">&#160;</text><ellipse cx="840.625" cy="5121.4714" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="155.2083" x="859.375" y="5124.4659">num_experts_per_tok: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5159.225">&#160;</text><ellipse cx="840.625" cy="5190.9894" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="859.375" y="5193.984">n_routed_experts: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5228.743">&#160;</text><ellipse cx="840.625" cy="5260.5075" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="131.25" x="859.375" y="5263.502">n_shared_experts: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5298.261">&#160;</text><ellipse cx="840.625" cy="5330.0255" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="100" x="859.375" y="5333.02">scoring_func: str</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5367.779">&#160;</text><ellipse cx="840.625" cy="5399.5435" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="127.0833" x="859.375" y="5402.538">aux_loss_alpha: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5437.2971">&#160;</text><ellipse cx="840.625" cy="5469.0615" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="84.375" x="859.375" y="5472.0561">seq_aux: bool</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="859.375" y="5506.8151">&#160;</text><ellipse cx="840.625" cy="5538.5796" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="859.375" y="5541.5741">norm_topk_prob: bool</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="830.2083" x2="1057.2917" y1="5558.5632" y2="5558.5632"/></g><!--class RMSNorm--><g id="elem_RMSNorm"><rect codeLine="66" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="270.3964" id="RMSNorm" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="176.0417" x="1979.6875" y="2434.8958"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="176.0417" x="1979.6875" y="2434.8958"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="176.0417" x="1979.6875" y="2475.9048"/><rect codeLine="66" fill="none" height="270.3964" id="RMSNorm" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="176.0417" x="1979.6875" y="2434.8958"/><ellipse cx="2023.9583" cy="2457.4837" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M2025.5046,2454.5703 Q2025.6185,2454.4075 2025.7487,2454.3261 Q2025.8952,2454.2447 2026.0579,2454.2447 Q2026.3346,2454.2447 2026.4974,2454.4401 Q2026.6764,2454.6354 2026.6764,2455.0748 L2026.6764,2456.149 Q2026.6764,2456.5885 2026.4974,2456.7838 Q2026.3346,2456.9791 2026.0579,2456.9791 Q2025.7975,2456.9791 2025.651,2456.8326 Q2025.5046,2456.7024 2025.4232,2456.3118 Q2025.3906,2456.0514 2025.2604,2455.9212 Q2025,2455.6445 2024.5443,2455.4817 Q2024.1048,2455.319 2023.6491,2455.319 Q2023.0957,2455.319 2022.6237,2455.5631 Q2022.1517,2455.8072 2021.7936,2456.3606 Q2021.4355,2456.8977 2021.4355,2457.6627 L2021.4355,2458.4765 Q2021.4355,2459.3717 2022.0866,2459.9739 Q2022.7539,2460.5761 2023.9095,2460.5761 Q2024.6094,2460.5761 2025.0977,2460.3971 Q2025.3743,2460.2832 2025.6836,2459.9576 Q2025.8789,2459.7623 2025.9928,2459.7135 Q2026.1068,2459.6484 2026.237,2459.6484 Q2026.4974,2459.6484 2026.6764,2459.8437 Q2026.8717,2460.0227 2026.8717,2460.2832 Q2026.8717,2460.5436 2026.6113,2460.8365 Q2026.237,2461.2597 2025.651,2461.5039 Q2024.8698,2461.8294 2023.9258,2461.8294 Q2022.8027,2461.8294 2021.9238,2461.3736 Q2021.1914,2461.0156 2020.6868,2460.218 Q2020.1823,2459.4205 2020.1823,2458.4928 L2020.1823,2457.6464 Q2020.1823,2456.6699 2020.638,2455.8235 Q2021.0938,2454.9772 2021.8913,2454.5214 Q2022.7051,2454.0657 2023.6003,2454.0657 Q2024.1536,2454.0657 2024.6257,2454.1959 Q2025.0977,2454.3098 2025.5046,2454.5703 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="58.3333" x="2054.1667" y="2462.0407">RMSNorm</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1980.7292" x2="2154.6875" y1="2480.0715" y2="2480.0715"/><ellipse cx="1991.1458" cy="2503.1802" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="56.25" x="2009.8958" y="2506.1747">eps: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="2009.8958" y="2540.9337">&#160;</text><ellipse cx="1991.1458" cy="2572.6982" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="2009.8958" y="2575.6927">weight: nn.Parameter</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1980.7292" x2="2154.6875" y1="2592.6819" y2="2592.6819"/><ellipse cx="1991.1458" cy="2615.7906" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="56.25" x="2009.8958" y="2618.7851">_norm(x)</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="2009.8958" y="2653.5441">&#160;</text><ellipse cx="1991.1458" cy="2685.3086" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="63.5417" x="2009.8958" y="2688.3031">forward(x)</text></g><!--class Attention--><g id="elem_Attention"><rect codeLine="80" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="965.5767" id="Attention" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="516.6667" x="1076.0417" y="2087.5"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="516.6667" x="1076.0417" y="2087.5"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="516.6667" x="1076.0417" y="2128.509"/><rect codeLine="80" fill="none" height="965.5767" id="Attention" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="516.6667" x="1076.0417" y="2087.5"/><ellipse cx="1293.2292" cy="2110.0878" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M1294.7754,2107.1744 Q1294.8893,2107.0117 1295.0195,2106.9303 Q1295.166,2106.8489 1295.3288,2106.8489 Q1295.6055,2106.8489 1295.7682,2107.0442 Q1295.9473,2107.2395 1295.9473,2107.679 L1295.9473,2108.7532 Q1295.9473,2109.1927 1295.7682,2109.388 Q1295.6055,2109.5833 1295.3288,2109.5833 Q1295.0684,2109.5833 1294.9219,2109.4368 Q1294.7754,2109.3066 1294.694,2108.916 Q1294.6615,2108.6555 1294.5313,2108.5253 Q1294.2708,2108.2486 1293.8151,2108.0859 Q1293.3757,2107.9231 1292.9199,2107.9231 Q1292.3665,2107.9231 1291.8945,2108.1673 Q1291.4225,2108.4114 1291.0645,2108.9648 Q1290.7064,2109.5019 1290.7064,2110.2669 L1290.7064,2111.0807 Q1290.7064,2111.9759 1291.3574,2112.5781 Q1292.0247,2113.1803 1293.1803,2113.1803 Q1293.8802,2113.1803 1294.3685,2113.0013 Q1294.6452,2112.8873 1294.9544,2112.5618 Q1295.1497,2112.3665 1295.2637,2112.3177 Q1295.3776,2112.2526 1295.5078,2112.2526 Q1295.7682,2112.2526 1295.9473,2112.4479 Q1296.1426,2112.6269 1296.1426,2112.8873 Q1296.1426,2113.1477 1295.8822,2113.4407 Q1295.5078,2113.8639 1294.9219,2114.108 Q1294.1406,2114.4335 1293.1966,2114.4335 Q1292.0736,2114.4335 1291.1947,2113.9778 Q1290.4622,2113.6197 1289.9577,2112.8222 Q1289.4531,2112.0247 1289.4531,2111.097 L1289.4531,2110.2506 Q1289.4531,2109.274 1289.9089,2108.4277 Q1290.3646,2107.5813 1291.1621,2107.1256 Q1291.9759,2106.6699 1292.8711,2106.6699 Q1293.4245,2106.6699 1293.8965,2106.8001 Q1294.3685,2106.914 1294.7754,2107.1744 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="53.125" x="1323.4375" y="2114.6449">Attention</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1077.0833" x2="1591.6667" y1="2132.6757" y2="2132.6757"/><ellipse cx="1087.5" cy="2155.7844" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="161.4583" x="1106.25" y="2158.7789">num_key_value_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2193.5379">&#160;</text><ellipse cx="1087.5" cy="2225.3024" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="108.3333" x="1106.25" y="2228.2969">n_local_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2263.0559">&#160;</text><ellipse cx="1087.5" cy="2294.8204" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="130.2083" x="1106.25" y="2297.8149">n_local_kv_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2332.574">&#160;</text><ellipse cx="1087.5" cy="2364.3384" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="58.3333" x="1106.25" y="2367.333">n_rep: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2402.092">&#160;</text><ellipse cx="1087.5" cy="2433.8565" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="82.2917" x="1106.25" y="2436.851">head_dim: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2471.61">&#160;</text><ellipse cx="1087.5" cy="2503.3745" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1106.25" y="2506.369">q_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2541.128">&#160;</text><ellipse cx="1087.5" cy="2572.8925" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1106.25" y="2575.887">k_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2610.6461">&#160;</text><ellipse cx="1087.5" cy="2642.4105" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1106.25" y="2645.4051">v_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2680.1641">&#160;</text><ellipse cx="1087.5" cy="2711.9286" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1106.25" y="2714.9231">o_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2749.6821">&#160;</text><ellipse cx="1087.5" cy="2781.4466" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="152.0833" x="1106.25" y="2784.4411">attn_dropout: nn.Dropout</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2819.2001">&#160;</text><ellipse cx="1087.5" cy="2850.9646" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="158.3333" x="1106.25" y="2853.9591">resid_dropout: nn.Dropout</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2888.7182">&#160;</text><ellipse cx="1087.5" cy="2920.4826" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="81.25" x="1106.25" y="2923.4772">dropout: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1106.25" y="2958.2362">&#160;</text><ellipse cx="1087.5" cy="2990.0007" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="62.5" x="1106.25" y="2992.9952">flash: bool</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1077.0833" x2="1591.6667" y1="3009.9843" y2="3009.9843"/><ellipse cx="1087.5" cy="3033.093" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="469.7917" x="1106.25" y="3036.0875">forward(x, position_embeddings, past_key_value, use_cache, attention_mask)</text></g><!--class FeedForward--><g id="elem_FeedForward"><rect codeLine="116" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="409.4325" id="FeedForward" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="173.9583" x="555.7292" y="3327.0833"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="173.9583" x="555.7292" y="3327.0833"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="173.9583" x="555.7292" y="3368.0923"/><rect codeLine="116" fill="none" height="409.4325" id="FeedForward" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="173.9583" x="555.7292" y="3327.0833"/><ellipse cx="590.9375" cy="3349.6712" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M592.4837,3346.7578 Q592.5977,3346.595 592.7279,3346.5136 Q592.8743,3346.4322 593.0371,3346.4322 Q593.3138,3346.4322 593.4766,3346.6276 Q593.6556,3346.8229 593.6556,3347.2623 L593.6556,3348.3365 Q593.6556,3348.776 593.4766,3348.9713 Q593.3138,3349.1666 593.0371,3349.1666 Q592.7767,3349.1666 592.6302,3349.0201 Q592.4837,3348.8899 592.4023,3348.4993 Q592.3698,3348.2389 592.2396,3348.1087 Q591.9792,3347.832 591.5234,3347.6692 Q591.084,3347.5065 590.6283,3347.5065 Q590.0749,3347.5065 589.6029,3347.7506 Q589.1309,3347.9947 588.7728,3348.5481 Q588.4147,3349.0852 588.4147,3349.8502 L588.4147,3350.664 Q588.4147,3351.5592 589.0658,3352.1614 Q589.7331,3352.7636 590.8887,3352.7636 Q591.5885,3352.7636 592.0768,3352.5846 Q592.3535,3352.4707 592.6628,3352.1451 Q592.8581,3351.9498 592.972,3351.901 Q593.0859,3351.8359 593.2161,3351.8359 Q593.4766,3351.8359 593.6556,3352.0312 Q593.8509,3352.2102 593.8509,3352.4707 Q593.8509,3352.7311 593.5905,3353.024 Q593.2161,3353.4472 592.6302,3353.6914 Q591.849,3354.0169 590.9049,3354.0169 Q589.7819,3354.0169 588.903,3353.5611 Q588.1706,3353.2031 587.666,3352.4055 Q587.1615,3351.608 587.1615,3350.6803 L587.1615,3349.8339 Q587.1615,3348.8574 587.6172,3348.011 Q588.0729,3347.1647 588.8704,3346.7089 Q589.6842,3346.2532 590.5794,3346.2532 Q591.1328,3346.2532 591.6048,3346.3834 Q592.0768,3346.4973 592.4837,3346.7578 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="76.0417" x="619.4792" y="3354.2282">FeedForward</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="556.7708" x2="728.6458" y1="3372.259" y2="3372.259"/><ellipse cx="567.1875" cy="3395.3677" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="121.875" x="585.9375" y="3398.3622">gate_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="585.9375" y="3433.1212">&#160;</text><ellipse cx="567.1875" cy="3464.8857" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="127.0833" x="585.9375" y="3467.8802">down_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="585.9375" y="3502.6393">&#160;</text><ellipse cx="567.1875" cy="3534.4037" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="110.4167" x="585.9375" y="3537.3983">up_proj: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="585.9375" y="3572.1573">&#160;</text><ellipse cx="567.1875" cy="3603.9218" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="121.875" x="585.9375" y="3606.9163">dropout: nn.Dropout</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="585.9375" y="3641.6753">&#160;</text><ellipse cx="567.1875" cy="3673.4398" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="92.7083" x="585.9375" y="3676.4343">act_fn: ACT2FN</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="556.7708" x2="728.6458" y1="3693.4235" y2="3693.4235"/><ellipse cx="567.1875" cy="3716.5321" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="63.5417" x="585.9375" y="3719.5267">forward(x)</text></g><!--class MoEGate--><g id="elem_MoEGate"><rect codeLine="136" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="757.0226" id="MoEGate" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="185.4167" x="206.25" y="3153.125"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="185.4167" x="206.25" y="3153.125"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="185.4167" x="206.25" y="3194.134"/><rect codeLine="136" fill="none" height="757.0226" id="MoEGate" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="185.4167" x="206.25" y="3153.125"/><ellipse cx="258.3333" cy="3175.7128" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M259.8796,3172.7994 Q259.9935,3172.6367 260.1237,3172.5553 Q260.2702,3172.4739 260.4329,3172.4739 Q260.7096,3172.4739 260.8724,3172.6692 Q261.0514,3172.8645 261.0514,3173.304 L261.0514,3174.3782 Q261.0514,3174.8177 260.8724,3175.013 Q260.7096,3175.2083 260.4329,3175.2083 Q260.1725,3175.2083 260.026,3175.0618 Q259.8796,3174.9316 259.7982,3174.541 Q259.7656,3174.2805 259.6354,3174.1503 Q259.375,3173.8736 258.9193,3173.7109 Q258.4798,3173.5481 258.0241,3173.5481 Q257.4707,3173.5481 256.9987,3173.7923 Q256.5267,3174.0364 256.1686,3174.5898 Q255.8105,3175.1269 255.8105,3175.8919 L255.8105,3176.7057 Q255.8105,3177.6009 256.4616,3178.2031 Q257.1289,3178.8053 258.2845,3178.8053 Q258.9844,3178.8053 259.4727,3178.6263 Q259.7493,3178.5123 260.0586,3178.1868 Q260.2539,3177.9915 260.3678,3177.9427 Q260.4818,3177.8776 260.612,3177.8776 Q260.8724,3177.8776 261.0514,3178.0729 Q261.2467,3178.2519 261.2467,3178.5123 Q261.2467,3178.7727 260.9863,3179.0657 Q260.612,3179.4889 260.026,3179.733 Q259.2448,3180.0585 258.3008,3180.0585 Q257.1777,3180.0585 256.2988,3179.6028 Q255.5664,3179.2447 255.0618,3178.4472 Q254.5573,3177.6497 254.5573,3176.722 L254.5573,3175.8756 Q254.5573,3174.899 255.013,3174.0527 Q255.4688,3173.2063 256.2663,3172.7506 Q257.0801,3172.2949 257.9753,3172.2949 Q258.5286,3172.2949 259.0007,3172.4251 Q259.4727,3172.539 259.8796,3172.7994 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="52.0833" x="288.5417" y="3180.2699">MoEGate</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="207.2917" x2="390.625" y1="3198.3007" y2="3198.3007"/><ellipse cx="217.7083" cy="3221.4094" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="236.4583" y="3224.4039">config: MiniMindConfig</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3259.1629">&#160;</text><ellipse cx="217.7083" cy="3290.9274" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="57.2917" x="236.4583" y="3293.9219">top_k: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3328.6809">&#160;</text><ellipse cx="217.7083" cy="3360.4454" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="236.4583" y="3363.4399">n_routed_experts: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3398.199">&#160;</text><ellipse cx="217.7083" cy="3429.9634" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="100" x="236.4583" y="3432.958">scoring_func: str</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3467.717">&#160;</text><ellipse cx="217.7083" cy="3499.4815" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="67.7083" x="236.4583" y="3502.476">alpha: float</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3537.235">&#160;</text><ellipse cx="217.7083" cy="3568.9995" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="84.375" x="236.4583" y="3571.994">seq_aux: bool</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3606.753">&#160;</text><ellipse cx="217.7083" cy="3638.5175" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="236.4583" y="3641.512">norm_topk_prob: bool</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3676.2711">&#160;</text><ellipse cx="217.7083" cy="3708.0355" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="89.5833" x="236.4583" y="3711.0301">gating_dim: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3745.7891">&#160;</text><ellipse cx="217.7083" cy="3777.5536" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="236.4583" y="3780.5481">weight: nn.Parameter</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="207.2917" x2="390.625" y1="3797.5372" y2="3797.5372"/><ellipse cx="217.7083" cy="3820.6459" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="116.6667" x="236.4583" y="3823.6404">reset_parameters()</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="236.4583" y="3858.3995">&#160;</text><ellipse cx="217.7083" cy="3890.1639" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="138.5417" x="236.4583" y="3893.1585">forward(hidden_states)</text></g><!--class MOEFeedForward--><g id="elem_MOEFeedForward"><rect codeLine="166" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="478.9505" id="MOEFeedForward" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="370.8333" x="335.4167" y="2330.7292"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="370.8333" x="335.4167" y="2330.7292"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="370.8333" x="335.4167" y="2371.7382"/><rect codeLine="166" fill="none" height="478.9505" id="MOEFeedForward" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="370.8333" x="335.4167" y="2330.7292"/><ellipse cx="455.2083" cy="2353.317" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M456.7546,2350.4036 Q456.8685,2350.2408 456.9987,2350.1595 Q457.1452,2350.0781 457.3079,2350.0781 Q457.5846,2350.0781 457.7474,2350.2734 Q457.9264,2350.4687 457.9264,2350.9082 L457.9264,2351.9824 Q457.9264,2352.4218 457.7474,2352.6171 Q457.5846,2352.8124 457.3079,2352.8124 Q457.0475,2352.8124 456.901,2352.666 Q456.7546,2352.5358 456.6732,2352.1451 Q456.6406,2351.8847 456.5104,2351.7545 Q456.25,2351.4778 455.7943,2351.3151 Q455.3548,2351.1523 454.8991,2351.1523 Q454.3457,2351.1523 453.8737,2351.3964 Q453.4017,2351.6406 453.0436,2352.194 Q452.6855,2352.7311 452.6855,2353.496 L452.6855,2354.3098 Q452.6855,2355.205 453.3366,2355.8072 Q454.0039,2356.4095 455.1595,2356.4095 Q455.8594,2356.4095 456.3477,2356.2304 Q456.6243,2356.1165 456.9336,2355.791 Q457.1289,2355.5957 457.2428,2355.5468 Q457.3568,2355.4817 457.487,2355.4817 Q457.7474,2355.4817 457.9264,2355.677 Q458.1217,2355.8561 458.1217,2356.1165 Q458.1217,2356.3769 457.8613,2356.6699 Q457.487,2357.093 456.901,2357.3372 Q456.1198,2357.6627 455.1758,2357.6627 Q454.0527,2357.6627 453.1738,2357.207 Q452.4414,2356.8489 451.9368,2356.0514 Q451.4323,2355.2539 451.4323,2354.3261 L451.4323,2353.4798 Q451.4323,2352.5032 451.888,2351.6569 Q452.3438,2350.8105 453.1413,2350.3548 Q453.9551,2349.899 454.8503,2349.899 Q455.4036,2349.899 455.8757,2350.0292 Q456.3477,2350.1432 456.7546,2350.4036 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="102.0833" x="485.4167" y="2357.874">MOEFeedForward</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="336.4583" x2="705.2083" y1="2375.9048" y2="2375.9048"/><ellipse cx="346.875" cy="2399.0135" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="365.625" y="2402.0081">config: MiniMindConfig</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="365.625" y="2436.7671">&#160;</text><ellipse cx="346.875" cy="2468.5315" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="229.1667" x="365.625" y="2471.5261">experts: nn.ModuleList&lt;FeedForward&gt;</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="365.625" y="2506.2851">&#160;</text><ellipse cx="346.875" cy="2538.0496" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="87.5" x="365.625" y="2541.0441">gate: MoEGate</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="365.625" y="2575.8031">&#160;</text><ellipse cx="346.875" cy="2607.5676" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="277.0833" x="365.625" y="2610.5621">shared_experts: nn.ModuleList&lt;FeedForward&gt;</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="365.625" y="2645.3211">&#160;</text><ellipse cx="346.875" cy="2677.0856" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="87.5" x="365.625" y="2680.0802">aux_loss: float</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="336.4583" x2="705.2083" y1="2697.0693" y2="2697.0693"/><ellipse cx="346.875" cy="2720.178" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="63.5417" x="365.625" y="2723.1725">forward(x)</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="365.625" y="2757.9315">&#160;</text><ellipse cx="346.875" cy="2789.696" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="323.9583" x="365.625" y="2792.6905">moe_infer(x, flat_expert_indices, flat_expert_weights)</text></g><!--class MiniMindBlock--><g id="elem_MiniMindBlock"><rect codeLine="192" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="617.9866" id="MiniMindBlock" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="591.6667" x="588.5417" y="1369.7917"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="591.6667" x="588.5417" y="1369.7917"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="591.6667" x="588.5417" y="1410.8007"/><rect codeLine="192" fill="none" height="617.9866" id="MiniMindBlock" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="591.6667" x="588.5417" y="1369.7917"/><ellipse cx="828.6458" cy="1392.3795" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M830.1921,1389.4661 Q830.306,1389.3033 830.4362,1389.222 Q830.5827,1389.1406 830.7454,1389.1406 Q831.0221,1389.1406 831.1849,1389.3359 Q831.3639,1389.5312 831.3639,1389.9707 L831.3639,1391.0449 Q831.3639,1391.4843 831.1849,1391.6796 Q831.0221,1391.8749 830.7454,1391.8749 Q830.485,1391.8749 830.3385,1391.7285 Q830.1921,1391.5983 830.1107,1391.2076 Q830.0781,1390.9472 829.9479,1390.817 Q829.6875,1390.5403 829.2318,1390.3776 Q828.7923,1390.2148 828.3366,1390.2148 Q827.7832,1390.2148 827.3112,1390.4589 Q826.8392,1390.7031 826.4811,1391.2565 Q826.123,1391.7936 826.123,1392.5585 L826.123,1393.3723 Q826.123,1394.2675 826.7741,1394.8697 Q827.4414,1395.472 828.597,1395.472 Q829.2969,1395.472 829.7852,1395.2929 Q830.0618,1395.179 830.3711,1394.8535 Q830.5664,1394.6582 830.6803,1394.6093 Q830.7943,1394.5442 830.9245,1394.5442 Q831.1849,1394.5442 831.3639,1394.7395 Q831.5592,1394.9186 831.5592,1395.179 Q831.5592,1395.4394 831.2988,1395.7324 Q830.9245,1396.1555 830.3385,1396.3997 Q829.5573,1396.7252 828.6133,1396.7252 Q827.4902,1396.7252 826.6113,1396.2695 Q825.8789,1395.9114 825.3743,1395.1139 Q824.8698,1394.3164 824.8698,1393.3886 L824.8698,1392.5423 Q824.8698,1391.5657 825.3255,1390.7194 Q825.7813,1389.873 826.5788,1389.4173 Q827.3926,1388.9615 828.2878,1388.9615 Q828.8411,1388.9615 829.3132,1389.0917 Q829.7852,1389.2057 830.1921,1389.4661 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="82.2917" x="858.8542" y="1396.9365">MiniMindBlock</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="589.5833" x2="1179.1667" y1="1414.9673" y2="1414.9673"/><ellipse cx="600" cy="1438.076" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="152.0833" x="618.75" y="1441.0706">num_attention_heads: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1475.8296">&#160;</text><ellipse cx="600" cy="1507.594" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="93.75" x="618.75" y="1510.5886">hidden_size: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1545.3476">&#160;</text><ellipse cx="600" cy="1577.1121" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="82.2917" x="618.75" y="1580.1066">head_dim: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1614.8656">&#160;</text><ellipse cx="600" cy="1646.6301" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="113.5417" x="618.75" y="1649.6246">self_attn: Attention</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1684.3836">&#160;</text><ellipse cx="600" cy="1716.1481" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="71.875" x="618.75" y="1719.1427">layer_id: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1753.9017">&#160;</text><ellipse cx="600" cy="1785.6661" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="165.625" x="618.75" y="1788.6607">input_layernorm: RMSNorm</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1823.4197">&#160;</text><ellipse cx="600" cy="1855.1842" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="220.8333" x="618.75" y="1858.1787">post_attention_layernorm: RMSNorm</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="618.75" y="1892.9377">&#160;</text><ellipse cx="600" cy="1924.7022" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="261.4583" x="618.75" y="1927.6967">mlp: Union[FeedForward, MOEFeedForward]</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="589.5833" x2="1179.1667" y1="1944.6859" y2="1944.6859"/><ellipse cx="600" cy="1967.7945" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="544.7917" x="618.75" y="1970.7891">forward(hidden_states, position_embeddings, past_key_value, use_cache, attention_mask)</text></g><!--class MiniMindModel--><g id="elem_MiniMindModel"><rect codeLine="228" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="687.5046" id="MiniMindModel" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="435.4167" x="1818.75" y="582.2917"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="435.4167" x="1818.75" y="582.2917"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="435.4167" x="1818.75" y="623.3007"/><rect codeLine="228" fill="none" height="687.5046" id="MiniMindModel" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="435.4167" x="1818.75" y="582.2917"/><ellipse cx="1979.6875" cy="604.8795" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M1981.2337,601.9661 Q1981.3477,601.8033 1981.4779,601.722 Q1981.6243,601.6406 1981.7871,601.6406 Q1982.0638,601.6406 1982.2266,601.8359 Q1982.4056,602.0312 1982.4056,602.4707 L1982.4056,603.5449 Q1982.4056,603.9843 1982.2266,604.1796 Q1982.0638,604.3749 1981.7871,604.3749 Q1981.5267,604.3749 1981.3802,604.2285 Q1981.2337,604.0983 1981.1523,603.7076 Q1981.1198,603.4472 1980.9896,603.317 Q1980.7292,603.0403 1980.2734,602.8776 Q1979.834,602.7148 1979.3783,602.7148 Q1978.8249,602.7148 1978.3529,602.9589 Q1977.8809,603.2031 1977.5228,603.7565 Q1977.1647,604.2936 1977.1647,605.0585 L1977.1647,605.8723 Q1977.1647,606.7675 1977.8158,607.3697 Q1978.4831,607.972 1979.6387,607.972 Q1980.3385,607.972 1980.8268,607.7929 Q1981.1035,607.679 1981.4128,607.3535 Q1981.6081,607.1582 1981.722,607.1093 Q1981.8359,607.0442 1981.9661,607.0442 Q1982.2266,607.0442 1982.4056,607.2395 Q1982.6009,607.4186 1982.6009,607.679 Q1982.6009,607.9394 1982.3405,608.2324 Q1981.9661,608.6555 1981.3802,608.8997 Q1980.599,609.2252 1979.6549,609.2252 Q1978.5319,609.2252 1977.653,608.7695 Q1976.9206,608.4114 1976.416,607.6139 Q1975.9115,606.8164 1975.9115,605.8886 L1975.9115,605.0423 Q1975.9115,604.0657 1976.3672,603.2194 Q1976.8229,602.373 1977.6204,601.9173 Q1978.4342,601.4615 1979.3294,601.4615 Q1979.8828,601.4615 1980.3548,601.5917 Q1980.8268,601.7057 1981.2337,601.9661 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="84.375" x="2009.8958" y="609.4365">MiniMindModel</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1819.7917" x2="2253.125" y1="627.4673" y2="627.4673"/><ellipse cx="1830.2083" cy="650.576" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="1848.9583" y="653.5706">config: MiniMindConfig</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="688.3296">&#160;</text><ellipse cx="1830.2083" cy="720.094" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="89.5833" x="1848.9583" y="723.0886">vocab_size: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="757.8476">&#160;</text><ellipse cx="1830.2083" cy="789.6121" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="140.625" x="1848.9583" y="792.6066">num_hidden_layers: int</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="827.3656">&#160;</text><ellipse cx="1830.2083" cy="859.1301" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="181.25" x="1848.9583" y="862.1246">embed_tokens: nn.Embedding</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="896.8836">&#160;</text><ellipse cx="1830.2083" cy="928.6481" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="121.875" x="1848.9583" y="931.6427">dropout: nn.Dropout</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="966.4017">&#160;</text><ellipse cx="1830.2083" cy="998.1661" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="227.0833" x="1848.9583" y="1001.1607">layers: nn.ModuleList&lt;MiniMindBlock&gt;</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="1035.9197">&#160;</text><ellipse cx="1830.2083" cy="1067.6842" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="98.9583" x="1848.9583" y="1070.6787">norm: RMSNorm</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="1105.4377">&#160;</text><polygon fill="none" points="1830.2083,1131.9939,1834.375,1136.1605,1830.2083,1140.3272,1826.0417,1136.1605" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="141.6667" x="1848.9583" y="1140.1967">freqs_cos: torch.Tensor</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="1848.9583" y="1174.9557">&#160;</text><polygon fill="none" points="1830.2083,1201.5119,1834.375,1205.6786,1830.2083,1209.8452,1826.0417,1205.6786" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="138.5417" x="1848.9583" y="1209.7148">freqs_sin: torch.Tensor</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="1819.7917" x2="2253.125" y1="1226.7039" y2="1226.7039"/><ellipse cx="1830.2083" cy="1249.8126" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="388.5417" x="1848.9583" y="1252.8071">forward(input_ids, attention_mask, past_key_values, use_cache)</text></g><!--class MiniMindForCausalLM--><g id="elem_MiniMindForCausalLM"><rect codeLine="262" fill="url(#gbtucmjli9kwn1)" filter="url(#fbtucmjli9kwn)" height="339.9144" id="MiniMindForCausalLM" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="530.2083" x="2138.0208" y="142.7083"/><rect fill="url(#gbtucmjli9kwn2)" height="45.1757" rx="4.1667" ry="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="530.2083" x="2138.0208" y="142.7083"/><rect fill="url(#gbtucmjli9kwn2)" height="4.1667" style="stroke:url(#gbtucmjli9kwn2);stroke-width:1.0416666666666667;" width="530.2083" x="2138.0208" y="183.7173"/><rect codeLine="262" fill="none" height="339.9144" id="MiniMindForCausalLM" rx="4.1667" ry="4.1667" style="stroke:#2196F3;stroke-width:1.0416666666666667;" width="530.2083" x="2138.0208" y="142.7083"/><ellipse cx="2326.0417" cy="165.2962" fill="none" rx="10.4167" ry="10.4167" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><path d="M2327.5879,162.3828 Q2327.7018,162.22 2327.832,162.1386 Q2327.9785,162.0572 2328.1413,162.0572 Q2328.418,162.0572 2328.5807,162.2526 Q2328.7598,162.4479 2328.7598,162.8873 L2328.7598,163.9615 Q2328.7598,164.401 2328.5807,164.5963 Q2328.418,164.7916 2328.1413,164.7916 Q2327.8809,164.7916 2327.7344,164.6451 Q2327.5879,164.5149 2327.5065,164.1243 Q2327.474,163.8639 2327.3438,163.7337 Q2327.0833,163.457 2326.6276,163.2942 Q2326.1882,163.1315 2325.7324,163.1315 Q2325.179,163.1315 2324.707,163.3756 Q2324.235,163.6197 2323.877,164.1731 Q2323.5189,164.7102 2323.5189,165.4752 L2323.5189,166.289 Q2323.5189,167.1842 2324.1699,167.7864 Q2324.8372,168.3886 2325.9928,168.3886 Q2326.6927,168.3886 2327.181,168.2096 Q2327.4577,168.0957 2327.7669,167.7701 Q2327.9622,167.5748 2328.0762,167.526 Q2328.1901,167.4609 2328.3203,167.4609 Q2328.5807,167.4609 2328.7598,167.6562 Q2328.9551,167.8352 2328.9551,168.0957 Q2328.9551,168.3561 2328.6947,168.649 Q2328.3203,169.0722 2327.7344,169.3164 Q2326.9531,169.6419 2326.0091,169.6419 Q2324.8861,169.6419 2324.0072,169.1861 Q2323.2747,168.8281 2322.7702,168.0305 Q2322.2656,167.233 2322.2656,166.3053 L2322.2656,165.4589 Q2322.2656,164.4824 2322.7214,163.636 Q2323.1771,162.7897 2323.9746,162.3339 Q2324.7884,161.8782 2325.6836,161.8782 Q2326.237,161.8782 2326.709,162.0084 Q2327.181,162.1223 2327.5879,162.3828 Z " fill="#FFFFFF"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="125" x="2356.25" y="169.8532">MiniMindForCausalLM</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2139.0625" x2="2667.1875" y1="187.884" y2="187.884"/><ellipse cx="2149.4792" cy="210.9927" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="2168.2292" y="213.9872">config: MiniMindConfig</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="2168.2292" y="248.7462">&#160;</text><ellipse cx="2149.4792" cy="280.5107" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="130.2083" x="2168.2292" y="283.5052">model: MiniMindModel</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="2168.2292" y="318.2643">&#160;</text><ellipse cx="2149.4792" cy="350.0287" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="115.625" x="2168.2292" y="353.0233">lm_head: nn.Linear</text><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="2168.2292" y="387.7823">&#160;</text><ellipse cx="2149.4792" cy="419.5468" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="181.25" x="2168.2292" y="422.5413">OUT: CausalLMOutputWithPast</text><line style="stroke:#2196F3;stroke-width:1.0416666666666667;" x1="2139.0625" x2="2667.1875" y1="439.5304" y2="439.5304"/><ellipse cx="2149.4792" cy="462.6391" fill="none" rx="3.125" ry="3.125" style="stroke:#1A78C2;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="483.3333" x="2168.2292" y="465.6336">forward(input_ids, attention_mask, past_key_values, use_cache, logits_to_keep)</text></g><g id="elem_N1"><path d="M1626.0417,293.2292 L1626.0417,331.3375 A4.1667,4.1667 0 0 0 1630.2083,335.5042 L1773.9583,335.5042 A4.1667,4.1667 0 0 0 1778.125,331.3375 L1778.125,299.4792 L1767.7083,289.0625 L1630.2083,289.0625 A4.1667,4.1667 0 0 0 1626.0417,293.2292 " fill="url(#gbtucmjli9kwn3)" filter="url(#fbtucmjli9kwn)" style="stroke:#9C27B0;stroke-width:1.0416666666666667;"/><path d="M1767.7083,289.0625 L1767.7083,297.3958 A2.0833,2.0833 0 0 0 1769.7917,299.4792 L1778.125,299.4792 L1767.7083,289.0625 " fill="url(#gbtucmjli9kwn3)" style="stroke:#9C27B0;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="109.375" x="1642.7083" y="317.2546">Helper Functions</text></g><!--reverse link PretrainedConfig to MiniMindConfig--><g id="link_PretrainedConfig_MiniMindConfig"><path d="M98.3831,3581.5342 C105.2893,3647.7321 125.7292,3791.0313 187.5,3910.4167 C354.375,4232.9688 662.25,4536.9896 829.0729,4688.0521 " fill="none" id="PretrainedConfig-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="96.4375,3562.8854,92.1668,3582.1827,104.5993,3580.8857,96.4375,3562.8854" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link Module to RMSNorm--><g id="link_Module_RMSNorm"><path d="M923.0862,357.319 C1060.6278,512.6524 1683.4271,1211.9063 1801.0417,1269.7917 C1858.6979,1298.1771 2045.625,1253.2083 2088.5417,1301.0417 C2162.8021,1383.8125 2106.8958,2125.5833 2080.0104,2434.8333 " fill="none" id="Module-backto-RMSNorm" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="910.6563,343.2813,918.4069,361.4623,927.7654,353.1757,910.6563,343.2813" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link Module to Attention--><g id="link_Module_Attention"><path d="M901.9483,360.8618 C947.6046,484.6118 1116.0833,954.1667 1198.9583,1369.7917 C1252.9375,1640.5 1232.5104,1713.2188 1263.5417,1987.5 C1267.2188,2019.9792 1271.0833,2053.4688 1275.0417,2087.1979 " fill="none" id="Module-backto-Attention" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="895.4583,343.2708,896.0847,363.0251,907.812,358.6985,895.4583,343.2708" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link Attention to MiniMindConfig--><g id="link_Attention_MiniMindConfig"><path codeLine="112" d="M1247.2675,3065.5602 C1191.2988,3383.0706 1119.5,3790.3958 1058.3542,4137.3438 " fill="none" id="Attention-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="1249.4375,3053.25,1244.2491,3058.6818,1247.2675,3065.5602,1252.4559,3060.1284,1249.4375,3053.25" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="1230.5267,3536.1784,1234.2471,3529.1804,1229.4232,3528.3301,1230.5267,3536.1784" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="1251.0417" y="3537.0463">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1228.977" y="3084.8443">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1077.0469" y="4082.0712">1</text></g><!--reverse link Module to FeedForward--><g id="link_Module_FeedForward"><path d="M820.3378,340.8824 C678.3899,404.0386 280.2083,608.25 280.2083,925 C280.2083,925 280.2083,925 280.2083,2038.5417 C280.2083,2264.1458 230.5313,2844.6042 316.6667,3053.125 C339.8021,3109.1354 372.6667,3104.8958 409.375,3153.125 C462.3438,3222.7292 514.2083,3304.8333 555.5417,3374.6771 " fill="none" id="Module-backto-FeedForward" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="837.4688,333.2604,817.7972,335.1721,822.8785,346.5927,837.4688,333.2604" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link FeedForward to MiniMindConfig--><g id="link_FeedForward_MiniMindConfig"><path codeLine="132" d="M694.4896,3748.6446 C731.6875,3903.6654 781.5104,4111.3125 829.1458,4309.8646 " fill="none" id="FeedForward-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="691.5729,3736.4896,688.9796,3743.5393,694.4896,3748.6446,697.0829,3741.5949,691.5729,3736.4896" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="754.0971,3964.7725,754.72,3956.8715,749.957,3958.0144,754.0971,3964.7725" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="772.9167" y="3965.6921">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="674.162" y="3768.1727">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="802.1198" y="4265.6442">1</text></g><!--reverse link Module to MoEGate--><g id="link_Module_MoEGate"><path d="M818.5622,322.0904 C702.2706,339.1112 419.5833,397.0938 271.875,582.2917 C175.1771,703.5313 206.25,769.9167 206.25,925 C206.25,925 206.25,925 206.25,2571.3542 C206.25,2763.6875 224.9375,2976.6979 245.5313,3153.0625 " fill="none" id="Module-backto-MoEGate" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="837.1146,319.375,817.6571,315.9063,819.4674,328.2745,837.1146,319.375" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link MoEGate to MiniMindConfig--><g id="link_MoEGate_MiniMindConfig"><path codeLine="162" d="M397.4011,3724.3678 C512.8386,3948.9928 704.2708,4321.5 829.0833,4564.3646 " fill="none" id="MoEGate-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="391.6875,3713.25,390.8384,3720.7134,397.4011,3724.3678,398.2502,3716.9044,391.6875,3713.25" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="532.1128,3964.4268,530.8458,3956.6032,526.4893,3958.8421,532.1128,3964.4268" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="550" y="3965.6921">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="410.3203" y="3713.3894">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="802.0533" y="4536.4481">1</text></g><!--reverse link Module to MOEFeedForward--><g id="link_Module_MOEFeedForward"><path d="M865.5414,361.0106 C816.7914,484.9169 639.375,952.2188 569.7917,1369.7917 C514.8229,1699.625 509.5313,2087.1458 513.2292,2330.5104 " fill="none" id="Module-backto-MOEFeedForward" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="872.4063,343.5625,859.7254,358.7223,871.3575,363.2989,872.4063,343.5625" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link MOEFeedForward to MiniMindConfig--><g id="link_MOEFeedForward_MiniMindConfig"><path codeLine="184" d="M646.3634,2821.5579 C684.4259,2906.2558 717.875,2992.0729 742.7083,3084.375 C822.6771,3381.5833 870.8438,3716.4792 899.8542,4010.1563 " fill="none" id="MOEFeedForward-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="641.2396,2810.1563,640.0009,2817.565,646.3634,2821.5579,647.602,2814.1491,641.2396,2810.1563" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="894.6191,3536.15,895.4421,3528.2674,890.6517,3529.2891,894.6191,3536.15" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="913.5417" y="3537.0463">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="625.6312" y="2840.7984">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="880.4646" y="3989.0182">1</text></g><!--reverse link MOEFeedForward to FeedForward--><g id="link_MOEFeedForward_FeedForward"><path codeLine="186" d="M552.7315,2822.442 C572.9294,2981.442 597.6146,3175.7604 616.8229,3327 " fill="none" id="MOEFeedForward-backto-FeedForward" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="551.1563,2810.0417,547.8104,2816.7669,552.7315,2822.442,556.0773,2815.7168,551.1563,2810.0417" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="594.2751,3107.5626,595.7548,3099.7765,590.8956,3100.3937,594.2751,3107.5626" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="109.375" x="613.5417" y="3108.4005">contains experts</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="532.8735" y="2840.6804">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="9.375" x="595.4301" y="3305.8873">N</text></g><!--reverse link MOEFeedForward to MoEGate--><g id="link_MOEFeedForward_MoEGate"><path codeLine="188" d="M462.8188,2822.2202 C438.8813,2925.7202 413.0833,3037.2708 386.375,3152.7396 " fill="none" id="MOEFeedForward-backto-MoEGate" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="465.6354,2810.0417,460.1676,2815.192,462.8188,2822.2202,468.2866,2817.0698,465.6354,2810.0417" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="400.1028,3107.4887,404.1874,3100.6968,399.4151,3099.5931,400.1028,3107.4887" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="420.8333" y="3108.4005">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="444.8138" y="2840.6804">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="369.1044" y="3132.2569">1</text></g><!--reverse link Module to MiniMindBlock--><g id="link_Module_MiniMindBlock"><path d="M884.375,362.0521 C884.375,494.2292 884.375,1018.3021 884.375,1369.5521 " fill="none" id="Module-backto-MiniMindBlock" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="884.375,343.3021,878.125,362.0521,890.625,362.0521,884.375,343.3021" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link MiniMindBlock to MiniMindConfig--><g id="link_MiniMindBlock_MiniMindConfig"><path codeLine="214" d="M944.4676,1999.3228 C952.9676,2023.1041 958.5417,2034.5208 969.7917,2056.25 C978.3854,2072.8438 991.2188,2070.0521 997.9167,2087.5 C1065.1979,2262.8333 1027.0417,3276.2708 989.0729,4010.0729 " fill="none" id="MiniMindBlock-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="940.2604,1987.5521,938.4404,1994.8398,944.4676,1999.3228,946.2876,1992.0351,940.2604,1987.5521" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="1030.3007,3107.5948,1032.5821,3100.0048,1027.6851,3100.1134,1030.3007,3107.5948" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="1050" y="3108.4005">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="922.6075" y="2019.216">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="970.6591" y="3988.9339">1</text></g><!--reverse link MiniMindBlock to Attention--><g id="link_MiniMindBlock_Attention"><path codeLine="216" d="M965.2413,1998.7915 C977.0746,2023.104 985.2708,2035.1354 1001.0417,2056.25 C1016.0313,2076.3125 1030.6771,2069.3438 1047.9167,2087.5 C1057.4688,2097.5521 1066.8438,2107.9792 1076.0313,2118.7083 " fill="none" id="MiniMindBlock-backto-Attention" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="959.7708,1987.5521,958.7596,1994.9953,965.2413,1998.7915,966.2525,1991.3483,959.7708,1987.5521" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="1008.0358,2040.8646,1004.7197,2033.6662,1001.1219,2036.9902,1008.0358,2040.8646" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="55.2083" x="1025" y="2042.7755">contains</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="972.5776" y="2019.216">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1049.1787" y="2092.3525">1</text></g><!--reverse link MiniMindBlock to RMSNorm--><g id="link_MiniMindBlock_RMSNorm"><path codeLine="218" d="M1191.602,1825.5977 C1328.7582,1896.8789 1479.1667,1984.4271 1611.4583,2087.5 C1753.8958,2198.4792 1892.9583,2354.1771 1979.375,2458.2188 " fill="none" id="MiniMindBlock-backto-RMSNorm" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="1180.5104,1819.8333,1184.1347,1826.4127,1191.602,1825.5977,1187.9776,1819.0183,1180.5104,1819.8333" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="1564.7071,2040.4131,1560.3635,2033.7839,1557.2965,2037.6031,1564.7071,2040.4131" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="55.2083" x="1581.25" y="2042.7755">contains</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1199.1806" y="1810.6848">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1952.7454" y="2435.8879">2</text></g><!--reverse link MiniMindBlock to FeedForward--><g id="link_MiniMindBlock_FeedForward"><path codeLine="220" d="M819.9084,2000.0617 C814.3564,2033.6346 811.3542,2055.0625 807.2917,2087.5 C750.0521,2544.5521 812.0521,2666.5104 742.7083,3121.875 C732.4375,3189.3333 716.3542,3261.9688 700.0625,3327.0417 " fill="none" id="MiniMindBlock-backto-FeedForward" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="821.9479,1987.7292,816.8173,1993.2156,819.9084,2000.0617,825.039,1994.5752,821.9479,1987.7292" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="811.0835,2574.7664,814.2007,2567.4797,809.3224,2567.0391,811.0835,2574.7664" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="151.0417" x="831.25" y="2575.588">(conditionally) contains</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="801.1523" y="2019.3978">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="682.9832" y="3305.9306">1</text></g><!--reverse link MiniMindBlock to MOEFeedForward--><g id="link_MiniMindBlock_MOEFeedForward"><path codeLine="222" d="M582.2181,1984.9587 C573.7598,1999.5421 572.3438,2003.6146 565.625,2018.75 C522.8229,2115.1563 508.5313,2230.3542 506.1563,2330.3958 " fill="none" id="MiniMindBlock-backto-MOEFeedForward" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="588.4896,1974.1458,581.7495,1977.4618,582.2181,1984.9587,588.9581,1981.6428,588.4896,1974.1458" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="568.8957,2041.8733,572.9084,2035.0388,568.1247,2033.9855,568.8957,2041.8733" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="151.0417" x="589.5833" y="2042.7755">(conditionally) contains</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="561.4928" y="1969.0962">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="486.4461" y="2309.5232">1</text></g><!--reverse link Module to MiniMindModel--><g id="link_Module_MiniMindModel"><path d="M949.7407,325.4618 C1077.5011,349.8368 1420.7604,425.5208 1679.1667,582.2917 C1727.6667,611.7188 1774.9063,648.75 1818.3125,687.5104 " fill="none" id="Module-backto-MiniMindModel" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="931.3229,321.9479,948.5694,331.6011,950.912,319.3225,931.3229,321.9479" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link MiniMindModel to MiniMindConfig--><g id="link_MiniMindModel_MiniMindConfig"><path codeLine="252" d="M2202.8414,1281.7324 C2215.4455,1315.0344 2222.5938,1336.9479 2232.2917,1369.7917 C2271.5208,1502.6458 2281.25,1539.0833 2281.25,1677.6042 C2281.25,1677.6042 2281.25,1677.6042 2281.25,3532.8125 C2281.25,4201.0208 1382.3021,4616.8958 1058.3646,4745.0625 " fill="none" id="MiniMindModel-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="2198.4167,1270.0417,2196.7321,1277.3619,2202.8414,1281.7324,2204.5259,1274.4121,2198.4167,1270.0417" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="2284.1093,2574.5729,2288.7998,2568.1844,2284.1489,2566.6475,2284.1093,2574.5729" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="2305.2083" y="2575.588">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2183.1208" y="1301.5101">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1077.058" y="4728.7219">1</text></g><!--reverse link MiniMindModel to MiniMindBlock--><g id="link_MiniMindModel_MiniMindBlock"><path codeLine="254" d="M1961.4421,1280.7648 C1947.7234,1305.8064 1937.3229,1318.2083 1917.7083,1338.5417 C1724.5313,1538.8125 1411.3125,1620.875 1180.2917,1654.4479 " fill="none" id="MiniMindModel-backto-MiniMindBlock" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="1967.4479,1269.8021,1960.7908,1273.2815,1961.4421,1280.7648,1968.0993,1277.2854,1967.4479,1269.8021" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="1946.2413,1321.8939,1954.0978,1320.8505,1951.984,1316.4318,1946.2413,1321.8939" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="98.9583" x="1969.7917" y="1325.0671">contains layers</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1946.7387" y="1301.2649">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="9.375" x="1198.9698" y="1640.9063">N</text></g><!--reverse link MiniMindModel to RMSNorm--><g id="link_MiniMindModel_RMSNorm"><path codeLine="256" d="M2133.9206,1282.5953 C2135.6185,1292.9391 2135.125,1290.8854 2136.4583,1301.0417 C2190.3958,1711.5104 2128.2396,2202.0521 2091.2604,2434.4375 " fill="none" id="MiniMindModel-backto-RMSNorm" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="2131.8958,1270.2604,2128.7966,1277.1028,2133.9206,1282.5953,2137.0199,1275.753,2131.8958,1270.2604" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="2161.3041,1683.1138,2164.0305,1675.672,2159.1357,1675.4908,2161.3041,1683.1138" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="2181.25" y="1683.9213">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2114.7882" y="1300.602">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2073.0009" y="2413.6341">1</text></g><!--reverse link PreTrainedModel to MiniMindForCausalLM--><g id="link_PreTrainedModel_MiniMindForCausalLM"><path d="M2403.125,98.2813 C2403.125,114.9479 2403.125,118.3958 2403.125,142.4688 " fill="none" id="PreTrainedModel-backto-MiniMindForCausalLM" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="2403.125,79.5313,2396.875,98.2813,2409.375,98.2813,2403.125,79.5313" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--link MiniMindForCausalLM to GenerationMixin--><g id="link_MiniMindForCausalLM_GenerationMixin"><path codeLine="276" d="M2438.8438,482.6458 C2469.2708,626.6875 2506.5811,803.3115 2522.1332,876.8948 " fill="none" id="MiniMindForCausalLM-to-GenerationMixin" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="none" points="2526.0104,895.2396,2528.2481,875.6024,2516.0183,878.1872,2526.0104,895.2396" style="stroke:#2196F3;stroke-width:3.125;"/></g><!--reverse link MiniMindForCausalLM to MiniMindConfig--><g id="link_MiniMindForCausalLM_MiniMindConfig"><path codeLine="278" d="M2403.125,495.0625 C2403.125,617.8333 2403.125,775.4479 2403.125,925 C2403.125,925 2403.125,925 2403.125,3532.8125 C2403.125,3705.8438 2409.2604,3769.8646 2308.3333,3910.4167 C1977.5521,4371.0729 1322.8021,4649.7188 1058.4479,4747.6667 " fill="none" id="MiniMindForCausalLM-backto-MiniMindConfig" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="2403.125,482.5625,2398.9583,488.8125,2403.125,495.0625,2407.2917,488.8125,2403.125,482.5625" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="2406.0355,2041.777,2410.6431,2035.3285,2405.9728,2033.8517,2406.0355,2041.777" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="31.25" x="2427.0833" y="2042.7755">uses</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2383.7142" y="514.061">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="1077.1467" y="4769.1785">1</text></g><!--reverse link MiniMindForCausalLM to MiniMindModel--><g id="link_MiniMindForCausalLM_MiniMindModel"><path codeLine="280" d="M2295.2907,493.3664 C2276.4782,524.7414 2262.6458,547.8021 2242.0104,582.2292 " fill="none" id="MiniMindForCausalLM-backto-MiniMindModel" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#2196F3" points="2301.7188,482.6458,2294.9312,485.8634,2295.2907,493.3664,2302.0782,490.1488,2301.7188,482.6458" style="stroke:#2196F3;stroke-width:3.125;"/><polygon fill="#222222" points="2275.9824,536.1694,2281.9589,530.9642,2277.7579,528.4454,2275.9824,536.1694" style="stroke:#222222;stroke-width:1.0416666666666667;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="55.2083" x="2297.9167" y="537.5671">contains</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2277.713" y="514.1481">1</text><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="8.3333" x="2227.7362" y="561.3302">1</text></g><!--link N1 to Attention--><g id="link_N1_Attention"><path codeLine="286" d="M1688.5729,336.1354 C1626.8021,440.9271 1370.7396,891.9479 1288.5417,1301.0417 C1259.1667,1447.25 1273.2487,1787.2335 1293.4362,2081.046 " fill="none" id="N1-to-Attention" style="stroke:#2196F3;stroke-width:3.125;stroke-dasharray:7.0,7.0;"/><polygon fill="#2196F3" points="1293.8646,2087.2813,1297.3788,2077.6427,1293.5076,2082.0852,1289.0651,2078.2139,1293.8646,2087.2813" style="stroke:#2196F3;stroke-width:3.125;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="597.9167" x="1300" y="1325.0671">precompute_freqs_cis (indirectly via MiniMindModel init), apply_rotary_pos_emb, repeat_kv</text></g><!--link N1 to MiniMindModel--><g id="link_N1_MiniMindModel"><path codeLine="288" d="M1714.3854,336.0313 C1737.8542,378.9583 1788.8341,472.1937 1846.032,576.7666 " fill="none" id="N1-to-MiniMindModel" style="stroke:#2196F3;stroke-width:3.125;stroke-dasharray:7.0,7.0;"/><polygon fill="#2196F3" points="1849.0313,582.25,1848.188,572.0255,1846.5319,577.6805,1840.8769,576.0244,1849.0313,582.25" style="stroke:#2196F3;stroke-width:3.125;"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="144.7917" x="1840.625" y="537.5671">precompute_freqs_cis</text></g><!--SRC=[hLTDR-Cs4BtxLx3k9McT0DcZK1ZOfids43j1cqKFHK7GujXcBP4AIJdsjltl7OgMHD6IuomsW6DhFiZXcpSpr7Ts3JcGd5dGWetmBysOCUH9WzLCIE2tIYx5Af0_U_bCSSXgyIUGe9aLIix4JiXQBEKrcfKPj0lFX1JuEInBO6T1ykFzo3-Z4I4_SgqALTg4B3F5R2LQA4Ejse2aWYT4I2-5NkbQS8uYbk8AnkfGPiGNQ0tn6tGEN20EaIfdEree8zpXAEGBu5p8bMaDP9bJPl4ObSKQ68-KXnqpjWSTgJQmfrkMbH3xRLNA5b4aEZTKAfrJA4o826845FDeMIXT8jnh5vXCo4Afh1AM1cYk892uA61NWBQ6udy7OX0YrOW-yDeYr9WrqtqQaogD0D5bATCMTLRkQAQCeImhrfqu3RnGr8OXkJDQLMneeTMYLlpNSkYtsUzpj6d8qz3im9e8drSGgpKo0CsUc6OvOAuh1QdWlDXT-gUbqgzCy-evsErZdTl1_Kvc4XEFkSo6n9ljiKP34N0OjPIBl9MyE5p-hixpW1N3_64slT9jhrJrIXrNQ5DngFl5__Oa0oFueBQdJYl-1LbjuPsGddf28JEsXN5275TJbgxnPrjUEJCRdvusBUERCVdXwghwZjfBubOnPDfcynw0t_j81lEvSbsW3o6kNcMleYpwxGVWmeP4brYN7s-VFzpFUzaNnlck0yxKtIUCV_1mQUMOH0jLAgmvUbRr3zJurvQsXzmjsE7vSDqY6S7IeXQQYwY2wnvl4GZZyQnXUH-MZtVdyEK4f0rqZS-3CFQdODLfGxcapfq7B-glRonGDzWG_mwdt3EsVYha4hGhGYnGUrWUXLoaOBf2Zt-DNnUAis3iyL7EPpxkb652442Bmz-Gmsa7d9iD3xdiITWXb9-nkMvEzkl1YTrxFpXkmWQovM6wDfseKbHZldCB4R8ehH__Zlz9FRyg9RP26mGpO9LdE14-IxJuCm1b4X7qhnDLy6sQRXVVyqWmwD9sy801mnuVnitWFyl-9cRP1Jhn2WAMPVlBCzU8U7XwcMCcLjVah-aSVJV04xV9Agd-2koRnLsTvPEJg5wcsrqwQ4oRpjtXvFTB3I-6fWgzhTBf-lePjrOwq1aXZtKjFtrT26vYhiMqD04lkppqwBwBXwrBtOkwkG-uvS7fTwxtQodPzgAO0yYTMrOQbZtCmXUUy4NgRJxapYpfyigdCAzQM7ptUFpyd91wsyVI8jP_2Bj-GcI_GHec95ChOTrB5nf0qKrBUE2hgt-dn- -7VPRlIkDRZXxL9AfEgTmLu5V8SCoGUxozk93Cc313vZUZqVo6N5zFEusfq92g7142UY2yCEJ2pKjKs6nFje95c-A3lKGmYoBRunNAChrtRv2kxqxmwb80ZjZDjjajZhXlHmpzVm00]--></g></svg>